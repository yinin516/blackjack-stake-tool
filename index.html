<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ä¿®æ­£ç‰ˆ Blackjack è¼”åŠ©å·¥å…·</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { background-color: #0f172a; font-family: 'Segoe UI', sans-serif; color: #e2e8f0; padding: 20px; }
    h1, h2 { color: #facc15; }
    .section, .stat-card, .chart-container {
      background-color: #1e293b; border-radius: 12px; padding: 20px; margin-bottom: 20px;
    }
    select, input, button { font-size: 16px; margin: 6px; border-radius: 8px; padding: 8px 10px; }
    select, input { background-color: #334155; color: white; border: none; }
    button { background: #22c55e; color: black; font-weight: bold; cursor: pointer; }
    .danger { background: #ef4444; color: white; }
    .result { margin-top: 10px; font-size: 18px; }
  </style>
</head>
<body>
  <h1>Stake çœŸäºº 21é» ä¿®æ­£ç‰ˆå·¥å…·</h1>

  <div class="section">
    <h2>åŸºæœ¬ç­–ç•¥å»ºè­°</h2>
    <label>ä½ çš„ç‰Œï¼š</label>
    <select id="card1"></select>
    <select id="card2"></select>
    <select id="card3"><option value="">-</option></select>
    <select id="card4"><option value="">-</option></select>
    <select id="card5"><option value="">-</option></select>
    <label>èŠå®¶æ˜ç‰Œï¼š</label>
    <select id="dealerCard"></select>
    <button onclick="getStrategy()">å–å¾—å»ºè­°</button>
    <button class="danger" onclick="clearCards()">æ¸…ç©º</button>
    <div class="result" id="strategyResult">å»ºè­°æœƒé¡¯ç¤ºåœ¨é€™è£¡</div>
  </div>

  <script>
    const allRanks = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];
    ["card1","card2","card3","card4","card5","dealerCard"].forEach(id => {
      const sel = document.getElementById(id);
      allRanks.forEach(card => {
        const opt = document.createElement("option");
        opt.value = card;
        opt.text = card;
        sel.appendChild(opt);
      });
    });

    function getCardValue(c) {
      if (!c) return 0;
      if (["K","Q","J"].includes(c)) return 10;
      if (c === "A") return 11;
      return parseInt(c);
    }

    function isSoftHand(cards) {
      let aceCount = cards.filter(c => c === "A").length;
      let total = cards.map(getCardValue).reduce((a,b)=>a+b,0);
      while (total > 21 && aceCount > 0) {
        total -= 10; aceCount--;
      }
      return cards.includes("A") && total <= 21 && aceCount > 0;
    }

    function getStrategy() {
      const cards = [1,2,3,4,5].map(i => document.getElementById("card"+i).value).filter(Boolean);
      const dealer = document.getElementById("dealerCard").value;
      if (cards.length < 2 || !dealer) return;

      const total = cards.map(getCardValue).reduce((a,b)=>a+b,0);
      const dealerVal = getCardValue(dealer);
      const soft = isSoftHand(cards);

      let advice = "";

      if (cards.length === 2 && cards[0] === cards[1]) {
        const pair = cards[0];
        if (["A","8"].includes(pair)) advice = "âœŒï¸ åˆ†ç‰Œ";
        else if (pair === "9" && ![7,10,11].includes(dealerVal)) advice = "âœŒï¸ åˆ†ç‰Œ";
        else if (pair === "7" && dealerVal <= 7) advice = "âœŒï¸ åˆ†ç‰Œ";
        else if (pair === "6" && dealerVal <= 6) advice = "âœŒï¸ åˆ†ç‰Œ";
        else if (pair === "4" && dealerVal >= 5 && dealerVal <= 6) advice = "âœŒï¸ åˆ†ç‰Œ";
        else if (["2","3"].includes(pair) && dealerVal <= 7) advice = "âœŒï¸ åˆ†ç‰Œ";
      }

      if (!advice) {
        if (soft) {
          if (total <= 17) advice = "ğŸƒ å«ç‰Œ";
          else if (total === 18) {
            if ([9,10,11].includes(dealerVal)) advice = "ğŸƒ å«ç‰Œ";
            else if ([3,4,5,6].includes(dealerVal)) advice = "ğŸ’£ åŠ å€";
            else advice = "âœ‹ åœç‰Œ";
          } else {
            advice = "âœ‹ åœç‰Œ";
          }
        } else {
          if (total >= 17) advice = "âœ‹ åœç‰Œ";
          else if (total >= 13 && dealerVal <= 6) advice = "âœ‹ åœç‰Œ";
          else if (total === 12 && dealerVal >= 4 && dealerVal <= 6) advice = "âœ‹ åœç‰Œ";
          else if (total === 11) advice = "ğŸ’£ åŠ å€";
          else if (total === 10 && dealerVal <= 9) advice = "ğŸ’£ åŠ å€";
          else if (total === 9 && dealerVal >= 3 && dealerVal <= 6) advice = "ğŸ’£ åŠ å€";
          else advice = "ğŸƒ å«ç‰Œ";
        }
      }

      document.getElementById("strategyResult").innerText = `å»ºè­°ï¼š${advice}ï¼ˆ${soft ? "è»Ÿæ‰‹" : "ç¡¬æ‰‹"} ${total}ï¼‰`;
    }

    function clearCards() {
      ["card1","card2","card3","card4","card5","dealerCard"].forEach(id => {
        document.getElementById(id).value = "";
      });
      document.getElementById("strategyResult").innerText = "å»ºè­°æœƒé¡¯ç¤ºåœ¨é€™è£¡";
    }
  </script>
</body>
</html>