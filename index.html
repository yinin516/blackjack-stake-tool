<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>Stake Blackjack å…¨åŠŸèƒ½è¼”åŠ©å·¥å…·</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background-color: #0f172a;
      font-family: 'Segoe UI', sans-serif;
      color: #e2e8f0;
      padding: 20px;
    }
    h1, h2 {
      color: #facc15;
    }
    .section, .stat-card, .chart-container {
      background-color: #1e293b;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }
    label, select, input, button {
      font-size: 16px;
      margin: 6px;
    }
    select, input {
      background-color: #334155;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 8px;
    }
    button {
      background: #22c55e;
      color: black;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
    }
    .danger {
      background: #ef4444;
      color: white;
    }
    .result, .stat-card p {
      font-size: 18px;
      margin-top: 10px;
    }
    .win { color: #4ade80; }
    .loss { color: #f87171; }
    .profit { color: #facc15; }
  </style>
</head>
<body>
  <h1>Stake çœŸäºº 21é» è¼”åŠ©å·¥å…·</h1>

  <div class="section">
    <h2>ğŸ® æ¨¡å¼åˆ‡æ›</h2>
    <label>æ¨¡å¼ï¼š</label>
    <select id="modeSelect">
      <option value="live">çœŸäºº 21 é»</option>
      <option value="stake">Stake åŸå‰µ</option>
    </select>
  </div>

  <div class="section">
    <h2>ğŸ´ åŸºæœ¬ç­–ç•¥å»ºè­°</h2>
    <label>ä½ çš„ç‰Œï¼š</label>
    <select id="card1"></select>
    <select id="card2"></select>
    <select id="card3"><option value="">-</option></select>
    <select id="card4"><option value="">-</option></select>
    <select id="card5"><option value="">-</option></select>

    <label>èŠå®¶æ˜ç‰Œï¼š</label>
    <select id="dealerCard"></select>
    <button onclick="getStrategy()">å–å¾—å»ºè­°</button>
    <button class="danger" onclick="clearCards()">æ¸…ç©º</button>
    <div class="result" id="strategyResult">å»ºè­°æœƒé¡¯ç¤ºåœ¨é€™è£¡</div>
  </div>
    <div class="section">
    <h2>ğŸ“Š æ³¨ç¢¼å»ºè­°</h2>
    <label>æœ¬é‡‘ï¼š</label><input type="number" id="bankroll" value="1000">
    <label>ç¬¬ä¸€æ³¨ï¼š</label><input type="number" id="baseBet" value="50">
    <label>ç­–ç•¥ï¼š</label>
    <select id="bettingStrategy">
      <option value="flat">å›ºå®šæ³¨</option>
      <option value="martingale">é¦¬ä¸</option>
      <option value="fibonacci">è²»æ³¢é‚£å¥‘</option>
      <option value="anti-martingale">åé¦¬ä¸</option>
    </select>
    <button onclick="getNextBet()">ä¸‹ä¸€æ³¨å»ºè­°</button>
    <div class="result" id="betResult">å»ºè­°æ³¨ç¢¼æœƒé¡¯ç¤ºåœ¨é€™è£¡</div>
  </div>

  <div class="section" id="hiloSection">
    <h2>ğŸ§  ç®—ç‰Œå™¨ï¼ˆHi-Loï¼‰</h2>
    <p>é»é¸ä¸‹æ–¹çš„ç‰Œä¾†è¨˜éŒ„ Hi-Lo è¨ˆæ•¸ï¼š</p>
    <div id="cardButtons"></div>
    <div class="result" id="countResult">ç›®å‰è¨ˆæ•¸ï¼š0</div>
    <div class="result" id="countAdvice"></div>
    <button class="danger" onclick="resetCount()">ğŸ” é‡ç½®è¨ˆæ•¸</button>
  </div>

  <div class="section">
    <h2>ğŸ“˜ çµæœç´€éŒ„</h2>
    <button onclick="updateStats(currentBet(),'win')" style="background:#4ade80">ğŸ‰ WIN</button>
    <button onclick="updateStats(currentBet(),'lose')" style="background:#f87171">ğŸ’¥ LOSE</button>
    <button onclick="updateStats(currentBet(),'draw')" style="background:#fbbf24">ğŸ¤ DRAW</button>
    <button onclick="updateStats(currentBet(),'bust')" style="background:#7dd3fc">ğŸ’£ BUST</button>
  </div>

  <div class="stat-card">
    <p>ç¸½ä¸‹æ³¨é‡‘é¡ï¼š<span id="totalBet">0</span></p>
    <p>ç›®å‰åˆ©æ½¤ï¼š<span id="profit" class="profit">0</span></p>
    <p>å‹ï¼š<span id="wins" class="win">0</span> ï½œ è¼¸ï¼š<span id="losses" class="loss">0</span> ï½œ å’Œï¼š<span id="draws">0</span> ï½œ çˆ†ç‰Œï¼š<span id="busts">0</span></p>
  </div>

  <div class="chart-container">
    <canvas id="profitChart" height="150"></canvas>
  </div>
  <script>
  const allRanks = ["2","3","4","5","6","7","8","9","10","J","Q","K","A"];
  ["card1","card2","card3","card4","card5","dealerCard"].forEach(id => {
    const sel = document.getElementById(id);
    allRanks.forEach(card => {
      const opt = document.createElement("option");
      opt.value = card;
      opt.text = card;
      sel.appendChild(opt);
    });
  });

  window.onload = () => {
    const cardButtons = document.getElementById("cardButtons");
    allRanks.forEach(card => {
      const btn = document.createElement("button");
      btn.innerText = card;
      btn.style.margin = "6px";
      btn.onclick = () => handleHiLoCount(card);
      cardButtons.appendChild(btn);
    });
    document.getElementById("modeSelect").dispatchEvent(new Event("change"));
  };

  document.getElementById("modeSelect").addEventListener("change", () => {
    const mode = document.getElementById("modeSelect").value;
    const hilo = document.getElementById("hiloSection");
    hilo.style.display = (mode === "stake") ? "none" : "block";
  });

  let runningCount = 0;
  function handleHiLoCount(card) {
    if (["2","3","4","5","6"].includes(card)) runningCount++;
    else if (["10","J","Q","K","A"].includes(card)) runningCount--;
    document.getElementById("countResult").innerText = "ç›®å‰è¨ˆæ•¸ï¼š" + runningCount;
    document.getElementById("countAdvice").innerText =
      runningCount >= 3 ? "ğŸ”¥ æœ‰å„ªå‹¢å¯åŠ å¤§æ³¨" :
      runningCount <= -2 ? "âš ï¸ è¬¹æ…ä¸‹æ³¨" : "âš–ï¸ æ™®é€šä¸‹æ³¨";
  }

  function resetCount() {
    runningCount = 0;
    document.getElementById("countResult").innerText = "ç›®å‰è¨ˆæ•¸ï¼š0";
    document.getElementById("countAdvice").innerText = "";
  }

  function clearCards() {
    ["card1","card2","card3","card4","card5","dealerCard"].forEach(id => {
      document.getElementById(id).value = "";
    });
    document.getElementById("strategyResult").innerText = "å»ºè­°æœƒé¡¯ç¤ºåœ¨é€™è£¡";
  }
    function getCardValue(card) {
    if (["K","Q","J"].includes(card)) return 10;
    if (card === "A") return 11;
    return parseInt(card);
  }

  function shouldSplit(pairCard, dealerCard) {
    const v = getCardValue(pairCard);
    const d = getCardValue(dealerCard);
    if (pairCard === "A" || v === 8) return true;
    if (v === 10) return false;
    if (v === 9) return ![7,10,11].includes(d);
    if (v === 7) return d <= 7;
    if (v === 6) return d <= 6;
    if (v === 4) return d >= 5 && d <= 6;
    if (v === 2 || v === 3) return d <= 7;
    return false;
  }

  function getStrategy() {
    const c1 = document.getElementById("card1").value;
    const c2 = document.getElementById("card2").value;
    const dealer = document.getElementById("dealerCard").value;

    if (!c1 || !c2 || !dealer) {
      document.getElementById("strategyResult").innerText = "è«‹é¸æ“‡å…©å¼µç‰Œèˆ‡èŠå®¶æ˜ç‰Œ";
      return;
    }

    if (c1 === c2 && shouldSplit(c1, dealer)) {
      document.getElementById("strategyResult").innerText = "å»ºè­°ï¼šâœŒï¸ åˆ†ç‰Œ";
      return;
    }

    const total = getCardValue(c1) + getCardValue(c2);
    const dVal = getCardValue(dealer);
    let advice = "";

    if (total >= 17) advice = "âœ‹ åœç‰Œ";
    else if (total >= 13 && dVal <= 6) advice = "âœ‹ åœç‰Œ";
    else if (total === 12 && dVal >= 4 && dVal <= 6) advice = "âœ‹ åœç‰Œ";
    else if (total === 11) advice = "ğŸ’£ åŠ å€";
    else if (total === 10 && dVal <= 9) advice = "ğŸ’£ åŠ å€";
    else if (total === 9 && dVal >= 3 && dVal <= 6) advice = "ğŸ’£ åŠ å€";
    else advice = "ğŸƒ å«ç‰Œ";

    document.getElementById("strategyResult").innerText = "å»ºè­°ï¼š" + advice;
  }

  function currentBet() {
    const base = parseFloat(document.getElementById("baseBet").value);
    const strat = document.getElementById("bettingStrategy").value;
    let last = betHistory.at(-1);
    if (!last) return base;

    if (strat === "martingale" && last.result === "lose") return last.bet * 2;
    if (strat === "fibonacci") {
      const fib = [1,1,2,3,5,8,13];
      let loseCount = betHistory.filter(b => b.result === "lose").length;
      return base * fib[Math.min(loseCount, fib.length - 1)];
    }
    if (strat === "anti-martingale" && last.result === "win") return last.bet * 2;
    return base;
  }

  function getNextBet() {
    const next = currentBet();
    document.getElementById("betResult").innerText = "æ¨è–¦ä¸‹æ³¨ï¼š" + next.toFixed(2);
  }
    let stats = { totalBet: 0, profit: 0, wins: 0, losses: 0, draws: 0, busts: 0, history: [] };
  let betHistory = [];

  function updateStats(bet, result) {
    stats.totalBet += bet;
    let delta = 0;
    if (result === "win") { stats.wins++; delta = bet; }
    else if (result === "lose") { stats.losses++; delta = -bet; }
    else if (result === "draw") stats.draws++;
    else if (result === "bust") { stats.busts++; delta = -bet; }

    stats.profit += delta;
    stats.history.push(stats.profit);
    betHistory.push({ bet, result });

    document.getElementById("totalBet").innerText = stats.totalBet.toFixed(2);
    document.getElementById("profit").innerText = stats.profit.toFixed(2);
    document.getElementById("wins").innerText = stats.wins;
    document.getElementById("losses").innerText = stats.losses;
    document.getElementById("draws").innerText = stats.draws;
    document.getElementById("busts").innerText = stats.busts;

    chart.data.labels.push("å±€ " + stats.history.length);
    chart.data.datasets[0].data = stats.history;
    chart.update();
  }

  const ctx = document.getElementById("profitChart").getContext("2d");
  const chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: [],
      datasets: [{
        label: 'åˆ©æ½¤èµ°å‹¢',
        data: [],
        borderColor: '#facc15',
        backgroundColor: 'rgba(250,204,21,0.2)',
        tension: 0.3,
        fill: true
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { ticks: { color: '#e2e8f0' }},
        x: { ticks: { color: '#e2e8f0' }}
      },
      plugins: {
        legend: {
          labels: { color: '#e2e8f0' }
        }
      }
    }
  });
</script>
</body>
</html>