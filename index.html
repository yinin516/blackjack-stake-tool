<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>Stake Blackjack å…¨åŠŸèƒ½è¼”åŠ©å·¥å…·</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background-color: #0f172a;
      font-family: 'Segoe UI', sans-serif;
      color: #e2e8f0;
      padding: 20px;
    }
    h1, h2 {
      color: #facc15;
    }
    .section, .stat-card, .chart-container {
      background-color: #1e293b;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }
    label, select, input, button {
      font-size: 16px;
      margin: 6px;
    }
    select, input {
      background-color: #334155;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 8px;
    }
    button {
      background: #22c55e;
      color: black;
      font-weight: bold;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
    }
    .danger {
      background: #ef4444;
      color: white;
    }
    .result, .stat-card p {
      font-size: 18px;
      margin-top: 10px;
    }
    .win { color: #4ade80; }
    .loss { color: #f87171; }
    .profit { color: #facc15; }
  </style>
</head>
<body>
  <h1>Stake çœŸäºº 21é» è¼”åŠ©å·¥å…·</h1>

  <div class="section">
    <h2>ğŸ® æ¨¡å¼åˆ‡æ›</h2>
    <label>æ¨¡å¼ï¼š</label>
    <select id="modeSelect">
      <option value="live">çœŸäºº 21 é»</option>
      <option value="stake">Stake åŸå‰µ</option>
    </select>
  </div>

  <div class="section">
    <h2>ğŸ´ åŸºæœ¬ç­–ç•¥å»ºè­°</h2>
    <label>ä½ çš„ç‰Œï¼š</label>
    <select id="card1"></select>
    <select id="card2"></select>
    <select id="card3"><option value="">-</option></select>
    <select id="card4"><option value="">-</option></select>
    <select id="card5"><option value="">-</option></select>

    <label>èŠå®¶æ˜ç‰Œï¼š</label>
    <select id="dealerCard"></select>
    <button onclick="getStrategy()">å–å¾—å»ºè­°</button>
    <button class="danger" onclick="clearCards()">æ¸…ç©º</button>
    <div class="result" id="strategyResult">å»ºè­°æœƒé¡¯ç¤ºåœ¨é€™è£¡</div>
  </div>

  <div class="section">
    <h2>ğŸ“Š æ³¨ç¢¼å»ºè­°</h2>
    <label>æœ¬é‡‘ï¼š</label><input type="number" id="bankroll" value="1000">
    <label>ç¬¬ä¸€æ³¨ï¼š</label><input type="number" id="baseBet" value="50">
    <label>ç­–ç•¥ï¼š</label>
    <select id="bettingStrategy">
      <option value="flat">å›ºå®šæ³¨</option>
      <option value="martingale">é¦¬ä¸</option>
      <option value="fibonacci">è²»æ³¢é‚£å¥‘</option>
      <option value="anti-martingale">åé¦¬ä¸</option>
    </select>
    <button onclick="getNextBet()">ä¸‹ä¸€æ³¨å»ºè­°</button>
    <div class="result" id="betResult">å»ºè­°æ³¨ç¢¼æœƒé¡¯ç¤ºåœ¨é€™è£¡</div>
  </div>

  <div class="section">
    <h2>ğŸ§  ç®—ç‰Œå™¨ï¼ˆHi-Loï¼‰</h2>
    <label>é¸æ“‡ç‰Œï¼š</label>
    <select id="countCard"></select>
    <button onclick="addToCount()">åŠ å…¥</button>
    <button class="danger" onclick="resetCount()">é‡ç½®</button>
    <div class="result" id="countResult">ç›®å‰è¨ˆæ•¸ï¼š0</div>
    <div class="result" id="countAdvice"></div>
  </div>

  <div class="stat-card">
    <p>ç¸½ä¸‹æ³¨é‡‘é¡ï¼š<span id="totalBet">0</span></p>
    <p>ç›®å‰åˆ©æ½¤ï¼š<span id="profit" class="profit">0</span></p>
    <p>å‹ï¼š<span id="wins" class="win">0</span> ï½œ è¼¸ï¼š<span id="losses" class="loss">0</span> ï½œ å’Œï¼š<span id="draws">0</span> ï½œ çˆ†ç‰Œï¼š<span id="busts">0</span></p>
  </div>

  <div class="chart-container">
    <canvas id="profitChart" height="150"></canvas>
  </div>

  <script>
   // å»ºç‰Œé¢é¸å–®
const allRanks = ["A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];
const cardSelectors = ["card1", "card2", "card3", "card4", "card5", "dealerCard", "countCard"];
cardSelectors.forEach(id => {
  const el = document.getElementById(id);
  allRanks.forEach(r => {
    const opt = document.createElement("option");
    opt.value = r;
    opt.text = r;
    el.appendChild(opt);
  });
});

// æ¸…ç©ºç‰Œé¢
function clearCards() {
  ["card1", "card2", "card3", "card4", "card5", "dealerCard"].forEach(id => {
    document.getElementById(id).value = "";
  });
  document.getElementById("strategyResult").innerText = "å»ºè­°æœƒé¡¯ç¤ºåœ¨é€™è£¡";
}

// ç‰Œé¢è½‰æ•¸å€¼
function getCardValue(c) {
  if (c === "A") return 11;
  if (["K", "Q", "J"].includes(c)) return 10;
  return parseInt(c);
}

// åŸºæœ¬ç­–ç•¥å»ºè­°ï¼ˆç°¡åŒ–ç‰ˆï¼‰
function getStrategy() {
  const c1 = document.getElementById("card1").value;
  const c2 = document.getElementById("card2").value;
  const dealer = document.getElementById("dealerCard").value;
  if (!c1 || !c2 || !dealer) return;

  const total = getCardValue(c1) + getCardValue(c2);
  let advice = "";

  if (total >= 17) advice = "åœç‰Œ";
  else if (total >= 13 && ["2", "3", "4", "5", "6"].includes(dealer)) advice = "åœç‰Œ";
  else if (total === 11) advice = "åŠ å€";
  else if (total === 10 && getCardValue(dealer) < 10) advice = "åŠ å€";
  else if (total === 9 && ["3", "4", "5", "6"].includes(dealer)) advice = "åŠ å€";
  else advice = "å«ç‰Œ";

  document.getElementById("strategyResult").innerText = "å»ºè­°ï¼š" + advice;
}

// æ³¨ç¢¼å»ºè­°é‚è¼¯
let betHistory = [];
function getNextBet() {
  const bankroll = parseFloat(document.getElementById("bankroll").value);
  const base = parseFloat(document.getElementById("baseBet").value);
  const strat = document.getElementById("bettingStrategy").value;

  let next = base;
  if (strat === "martingale" && betHistory.length > 0 && betHistory[betHistory.length-1].result === "lose") {
    next = betHistory[betHistory.length-1].bet * 2;
  } else if (strat === "fibonacci") {
    const fib = [base, base];
    for (let i = 2; i < 20; i++) fib[i] = fib[i-1] + fib[i-2];
    let loseCount = betHistory.filter(b => b.result === "lose").length;
    next = fib[Math.min(loseCount, 19)];
  } else if (strat === "anti-martingale" && betHistory.length > 0 && betHistory[betHistory.length-1].result === "win") {
    next = betHistory[betHistory.length-1].bet * 2;
  }

  document.getElementById("betResult").innerText = "æ¨è–¦ä¸‹æ³¨ï¼š" + next.toFixed(2);
}

// ç®—ç‰Œå™¨
let count = 0;
function addToCount() {
  const card = document.getElementById("countCard").value;
  if (!card) return;
  if (["2", "3", "4", "5", "6"].includes(card)) count++;
  else if (["10", "J", "Q", "K", "A"].includes(card)) count--;
  document.getElementById("countResult").innerText = "ç›®å‰è¨ˆæ•¸ï¼š" + count;
  let advice = "ä¸‹æ³¨ä¸­ç­‰";
  if (count >= 3) advice = "å¤§æ³¨ï¼æœ‰å„ªå‹¢";
  if (count <= -2) advice = "ä¿å®ˆä¸‹æ³¨";
  document.getElementById("countAdvice").innerText = advice;
}
function resetCount() {
  count = 0;
  document.getElementById("countResult").innerText = "ç›®å‰è¨ˆæ•¸ï¼š0";
  document.getElementById("countAdvice").innerText = "";
}

// çµ±è¨ˆè³‡æ–™èˆ‡åœ–è¡¨æ›´æ–°
let stats = {
  totalBet: 0, profit: 0, wins: 0, losses: 0, draws: 0, busts: 0, history: []
};
const totalBetEl = document.getElementById("totalBet");
const profitEl = document.getElementById("profit");
const winsEl = document.getElementById("wins");
const lossesEl = document.getElementById("losses");
const drawsEl = document.getElementById("draws");
const bustsEl = document.getElementById("busts");

const ctx = document.getElementById("profitChart").getContext("2d");
const chart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: [],
    datasets: [{
      label: 'åˆ©æ½¤èµ°å‹¢',
      data: [],
      borderColor: '#f87171',
      backgroundColor: 'rgba(248,113,113,0.2)',
      tension: 0.3,
      fill: true
    }]
  },
  options: {
    responsive: true,
    scales: {
      y: { ticks: { color: '#e2e8f0' }},
      x: { ticks: { color: '#e2e8f0' }}
    },
    plugins: {
      legend: {
        labels: { color: '#e2e8f0' }
      }
    }
  }
});

// æ¨¡æ“¬çµæœç´€éŒ„ï¼šä½ å¯ä»¥å‘¼å« updateStats(bet, result)
function updateStats(bet, result) {
  stats.totalBet += bet;
  let delta = 0;
  if (result === "win") { stats.wins++; delta = bet; }
  else if (result === "lose") { stats.losses++; delta = -bet; }
  else if (result === "draw") stats.draws++;
  else if (result === "bust") { stats.busts++; delta = -bet; }

  stats.profit += delta;
  stats.history.push(stats.profit);

  totalBetEl.innerText = stats.totalBet.toFixed(2);
  profitEl.innerText = stats.profit.toFixed(2);
  winsEl.innerText = stats.wins;
  lossesEl.innerText = stats.losses;
  drawsEl.innerText = stats.draws;
  bustsEl.innerText = stats.busts;

  chart.data.labels.push("å±€ " + stats.history.length);
  chart.data.datasets[0].data = stats.history;
  chart.update();
}
  </script>
</body>
</html>
